	LIST	P=PIC16F84A
	INCLUDE	"P16F84A.INC"
		
	__CONFIG    _HS_OSC&_WDT_OFF
		
CNT1	EQU	    0CH
CNT2	EQU	    0DH
CNT3	EQU	    0EH
TMP0	EQU	    11H
TMP1	EQU	    12H
TMP2	EQU	    13H
	ORG	    0H

MAIN	
	BSF	    STATUS , RP0
	CLRF	TRISB
	CLRF	TRISA
	BCF	    STATUS , RP0
	CLRF	PORTB
	CLRF	PORTA
MAINLP	
	MOVLW	B'00000001'
	MOVWF	TMP0
	MOVWF	TMP2
	CLRF	PORTA
	CALL	LEF
	CALL	RIG
	GOTO	MAINLP
LEF
	BCF		STATUS,	C
	MOVLW	008H
	MOVWF	TMP1
	CALL	LEFB
	RLF		TMP0
	MOVLW	002H
	MOVWF	TMP1
	CALL	LEFA
	RETURN
LEFB
	CALL	TIME100M
	MOVF	TMP2,	W
	IORWF	TMP0,	W
	MOVWF	PORTB
	BTFSC	TMP1,	B'00000000'
	RLF		TMP2,	F
	RLF		TMP0,	F
	DECFSZ	TMP1,	F
	GOTO	LEFB
	RETURN
LEFA
	CALL	TIME100M
	MOVF	TMP2,	W
	MOVWF	PORTB
	MOVF	TMP0,	W
	MOVWF	PORTA
	BTFSC	TMP1,	B'00000000'
	RLF		TMP2,	F
	RLF		TMP0
	DECFSZ	TMP1,	F
	GOTO	LEFA
	RETURN	
RIG
	RRF		TMP0
	MOVLW	002H
	MOVWF	TMP1
	CALL	RIGA
	RRF		TMP0
	MOVLW	004H
	MOVWF	TMP1
	CALL	RIGB
	RLF		TMP2
	MOVLW	004H
	MOVWF	TMP1
	CALL	RIGC
	RETURN
RIGA
	CALL	TIME100M
	MOVF	TMP0,	W
	MOVWF	PORTA
	MOVF	TMP2,	W
	MOVWF	PORTB
	BTFSC	TMP1,	B'00000000'
	RLF		TMP2,	F
	RRF		TMP0,	F
	DECFSZ	TMP1,	F
	GOTO	RIGA
	RETURN
RIGB
	BTFSS	TMP1,	B'00000010'
	CLRF	PORTA
	CALL	TIME100M
	MOVF	TMP2,	W
	IORWF	TMP0,	W
	MOVWF	PORTB
	RRF		TMP0
	BTFSC	TMP1,	B'00000000'
	RLF		TMP2,	F
	DECFSZ	TMP1,	F
	GOTO	RIGB
	RETURN
RIGC
	CALL	TIME100M
	MOVF	TMP0,	W
	MOVWF	PORTB
	MOVF	TMP2,	W
	MOVWF	PORTA
	RRF		TMP0
	BTFSC	TMP1,	B'00000000'
	RLF		TMP2,	F
	DECFSZ	TMP1,	F
	GOTO	RIGC
	RETURN
TIME100U						
	MOVLW	0A5H			
	MOVWF	CNT1			
	NOP						
	NOP						
LOOP1
	DECFSZ	CNT1,F			
	GOTO	LOOP1			
	RETURN					
		
TIME10M
	MOVLW	063H			
	MOVWF	CNT2			
	NOP						
	NOP		
LOOP2
	CALL	TIME100U
	DECFSZ	CNT2,F	
	GOTO	LOOP2			
	RETURN					
	
TIME100M
	MOVLW	0AH			
	MOVWF	CNT3
LOOP3
	CALL	TIME10M
	DECFSZ	CNT3,F
	GOTO	LOOP3
	RETURN
END